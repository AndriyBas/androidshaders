// Pixel shader to generate the Depth Map
// Used for shadow mapping - generates depth map from the light's viewpoint
precision mediump float;

varying vec4 position; 

void main() {
	
	// output the depth (z-coordinate in gl_FragCoord)
	//float depth = pow(gl_FragCoord.z, 3.0);
	float normalizedDistance  = position.z / position.w;
	normalizedDistance = (normalizedDistance + 1.0) / 2.0;
	
	normalizedDistance += 0.0005;

	//const vec3 multCoef = vec3(1.0, 256.0, 256.0 * 256.0 );
	//vec3 packedFloat = multCoef * normalizedDistance;
	//gl_FragColor = vec4(fract(packedFloat),1.0) + 0.5/255.0;;	

	
	//gl_FragColor = vec4(depth, depth, depth, depth);  
	gl_FragColor = vec4(normalizedDistance, normalizedDistance, normalizedDistance, normalizedDistance); 
	
}